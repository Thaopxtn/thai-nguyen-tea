<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trà Thái Nguyên - Tinh Hoa Trà Việt</title>
    <meta name="description" content="Thưởng thức hương vị trà Thái Nguyên thượng hạng. Đậm đà bản sắc Việt.">
    <meta property="og:title" content="Trà Thái Nguyên - Tinh Hoa Trà Việt">
    <meta property="og:description" content="Thưởng thức hương vị trà Thái Nguyên thượng hạng. Đậm đà bản sắc Việt.">
    <meta property="og:image" content="images/hero-bg.png">
    <meta property="og:type" content="website">
    <link rel="icon" href="images/product-1.png">
    <link rel="stylesheet" href="styles.css">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <!-- Header -->
    <header id="header">
        <div class="container">
            <nav>
                <a href="#" class="logo">
                    <i class="fas fa-leaf"></i> Thái Nguyên<span>Tea</span>
                </a>

                <ul class="nav-links" id="nav-links">
                    <li><a href="#home">Trang Chủ</a></li>
                    <li><a href="#products">Sản Phẩm</a></li>
                    <li><a href="#about">Câu Chuyện</a></li>
                    <li><a href="orders.html">Đơn Hàng</a></li>
                    <li><a href="news.html">Tin Tức</a></li>
                    <li><a href="#contact">Liên Hệ</a></li>
                </ul>

                <div class="header-actions">
                    <div class="cart-icon">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="cart-count">0</span>
                    </div>
                    <div class="menu-toggle" id="menu-toggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Tinh Hoa Trà Việt</h1>
            <p>Khám phá hương vị đậm đà, tinh tế từ những đồi chè xanh mướt Thái Nguyên. <br>Kết tinh của đất trời và
                bàn tay nghệ nhân.</p>
            <a href="#products" class="btn btn-accent">Khám Phá Ngay</a>
        </div>
    </section>

    <!-- Features / Intro -->
    <section class="section-padding text-center" style="background-color: white;">
        <div class="container">
            <div class="fade-in">
                <i class="fas fa-certificate"
                    style="font-size: 2.5rem; color: var(--color-accent); margin-bottom: 1rem;"></i>
                <h2 style="font-size: 2rem; color: var(--color-primary); margin-bottom: 1rem;">100% Tự Nhiên</h2>
                <p style="max-width: 600px; margin: 0 auto; color: var(--color-text-light);">Được trồng và chăm sóc theo
                    quy trình VietGAP, đảm bảo từng búp trà đều sạch và giữ trọn hương vị nguyên bản.</p>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="section-padding">
        <div class="container">
            <h2 class="section-title">Sản Phẩm Thượng Hạng</h2>
            <p class="subtitle">Tuyển tập những loại trà ngon nhất, được sao tẩm thủ công bởi các nghệ nhân lâu năm.</p>

            <div class="products-grid">
                <!-- Products will be loaded dynamically via script.js -->
                <div style="text-align:center; width: 100%; padding: 2rem;">Đang tải sản phẩm...</div>
            </div>

            <div class="text-center" style="margin-top: 4rem;">
                <a href="products.html" class="btn btn-accent">Xem Tất Cả Sản Phẩm</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="section-padding about">
        <div class="container about-container">
            <div class="about-content fade-in">
                <h2>Câu Chuyện Của Chúng Tôi</h2>
                <p>Sinh ra từ vùng đất danh trà Thái Nguyên, chúng tôi mang trong mình sứ mệnh gìn giữ và lan tỏa văn
                    hóa trà Việt. Mỗi búp trà không chỉ là thức uống, mà là câu chuyện về nắng, về gió, và về những giọt
                    mồ hôi của người nông dân.</p>
                <p>Chúng tôi cam kết mang đến những sản phẩm trà sạch, hương vị thuần khiết nhất, để mỗi chén trà bạn
                    thưởng thức đều là một khoảnh khắc an yên.</p>
                <a href="#contact" class="btn btn-accent" style="border: 1px solid white;">Liên Hệ Hợp Tác</a>
            </div>
            <div class="about-image fade-in">
                <img src="images/hero-bg.png" alt="Đồi chè Thái Nguyên">
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section class="section-padding" id="news-section" style="display: none;">
        <div class="container">
            <h2 class="section-title">Tin Tức & Sự Kiện</h2>
            <div class="news-grid" id="news-grid">
                <!-- Loaded dynamically -->
            </div>
            <div class="text-center" style="margin-top: 2rem;">
                <!-- Updated Button -->
                <button type="button" id="view-all-news-btn" class="btn btn-secondary">Xem Tất Cả Tin Tức</button>
            </div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="section-padding" style="background-color: #f0f0f0;">
        <div class="container text-center">
            <h2 style="margin-bottom: 2rem;">Đăng Ký Nhận Tin</h2>
            <p class="mb-2">Nhận ưu đãi đặc biệt và kiến thức về trà hàng tuần.</p>
            <form class="newsletter-form" style="max-width: 500px; margin: 0 auto;">
                <input type="email" placeholder="Địa chỉ email của bạn..." required
                    style="color: black; border-color: #ccc;">
                <button type="submit" class="btn btn-primary">Đăng Ký</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <a href="#" class="logo" style="color: white; margin-bottom: 1rem; display: block;">
                        <i class="fas fa-leaf"></i> Thái Nguyên<span>Tea</span>
                    </a>
                    <p>Tinh hoa trà Việt - Hương vị của đất trời.</p>
                </div>

                <div class="footer-col">
                    <h3>Liên Hệ</h3>
                    <p><i class="fas fa-map-marker-alt" style="width: 20px;"></i> Tân Cương, Thái Nguyên</p>
                    <p><i class="fas fa-phone" style="width: 20px;"></i> 0987 654 321</p>
                    <p><i class="fas fa-envelope" style="width: 20px;"></i> contact@thainguyentea.vn</p>
                </div>

                <div class="footer-col">
                    <h3>Kết Nối</h3>
                    <div class="social-links">
                        <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-icon"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>

            <div class="copyright">
                <p>&copy; 2024 Thai Nguyen Tea. All rights reserved. Designed by Antigravity.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        const LOCAL_FALLBACK = [
            {
                "id": 1,
                "name": "Trà Tân Cương Đặc Biệt",
                "price": 450000,
                "category": "Cao Cấp",
                "image": "images/product-1.png",
                "desc": "Hương vị đậm đà, nước xanh, vị chát dịu hậu ngọt sâu."
            },
            {
                "id": 2,
                "name": "Trà Móc Câu Hảo Hạng",
                "price": 320000,
                "category": "Truyền Thống",
                "image": "images/product-2.png",
                "desc": "Cánh trà xoăn nhỏ, hương cốm non nồng nàn."
            },
            {
                "id": 3,
                "name": "Trà Nõn Tôm Vương Giả",
                "price": 850000,
                "category": "Thượng Hạng",
                "image": "images/product-1.png",
                "desc": "Tuyệt phẩm trà Việt. Chỉ lấy 1 tôm 1 lá non nhất."
            },
            {
                "id": 4,
                "name": "Trà Shan Tuyết Cổ Thụ",
                "price": 550000,
                "category": "Cao Cấp",
                "image": "images/product-2.png",
                "desc": "Thu hái từ những cây chè cổ thụ trên núi cao, hương vị tinh khiết."
            },
            {
                "id": 5,
                "name": "Trà Lài Tự Nhiên",
                "price": 280000,
                "category": "Hương Hoa",
                "image": "images/product-1.png",
                "desc": "Ướp hương hoa lài tự nhiên, thơm ngát, dễ uống."
            },
            {
                "id": 6,
                "name": "Trà Sen Tây Hồ",
                "price": 1200000,
                "category": "Thượng Hạng",
                "image": "images/product-2.png",
                "desc": "Tinh hoa trà Việt. Ướp trong bông sen bách diệp hồ Tây."
            }
        ];

        // State function helpers
        function getSafeProducts() {
            if (typeof loadProducts === 'function') {
                const p = loadProducts();
                if (p && p.length > 0) return p;
            }
            return LOCAL_FALLBACK;
        }

        function renderHome() {
            const container = document.querySelector('.products-grid');
            if (!container) return;

            const products = getSafeProducts();
            const featured = products.slice(0, 3);

            if (featured.length === 0) {
                container.innerHTML = '<p class="text-center">Đang cập nhật sản phẩm...</p>';
                return;
            }

            container.innerHTML = featured.map(p => `
                <div class="product-card fade-in visible">
                    <div class="product-image">
                        <a href="detail.html?id=${p.id}">
                            <img src="${p.image}" alt="${p.name}">
                        </a>
                    </div>
                    <div class="product-info">
                        <span class="product-category">${p.category}</span>
                        <a href="detail.html?id=${p.id}" style="text-decoration: none; color: inherit;">
                            <h3 class="product-title">${p.name}</h3>
                        </a>
                        <span class="product-price">${Number(p.price).toLocaleString('vi-VN')}₫ / 500g</span>
                        <button class="btn btn-primary add-to-cart" data-id="${p.id}">Thêm Vào Giỏ</button>
                    </div>
                </div>
            `).join('');

            if (typeof attachCartListeners === 'function') {
                attachCartListeners();
            }
        }

        function renderNews() {
            const container = document.getElementById('news-grid');
            const btn = document.getElementById('view-all-news-btn');
            const section = document.getElementById('news-section');

            if (!container || typeof loadArticles !== 'function') return;

            const articles = loadArticles();

            // Handle Empty State
            if (!articles || articles.length === 0) {
                if (section) section.style.display = 'none';
                return;
            }
            if (section) section.style.display = 'block';

            // Always render only 3 items for the home page teaser
            const displayArticles = articles.slice(0, 3);

            // Render Grid
            container.innerHTML = displayArticles.map(a => `
                <div class="news-card fade-in">
                    <div class="news-image">
                        <img src="${a.image || ''}" alt="${a.title || 'News'}">
                    </div>
                    <div class="news-content">
                        <div class="news-date"><i class="far fa-calendar-alt"></i> ${a.date || ''}</div>
                        <a href="#" style="text-decoration: none; color: inherit;">
                            <h3>${a.title || 'Untitled'}</h3>
                        </a>
                        <p>${a.excerpt || ''}</p>
                        <a href="#" class="read-more">Xem Chi Tiết <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            `).join('');

            // Update Btn to be a direct link
            if (btn) {
                if (articles.length <= 3) {
                    btn.style.display = 'none';
                } else {
                    btn.style.display = 'inline-block';
                    // We set the click listener in initApp or here - let's do it cleanly here
                    // Replace with a clone to wipe any listeners from previous logic
                    const newBtn = btn.cloneNode(true);
                    btn.parentNode.replaceChild(newBtn, btn);

                    newBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        window.location.href = 'news.html';
                    });
                }
            }
        }

        // Init App
        function initApp() {
            renderHome();
            renderNews();
        }

        // Initialize when ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        document.addEventListener('appReady', () => {
            renderHome();
            renderNews();
        });

        window.addEventListener('storage', (e) => {
            if (e.key === 'thai_nguyen_articles') {
                renderNews();
            }
        });
    </script>
</body>

</html>